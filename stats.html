<!DOCTYPE html>
<html lang="ja">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Stats</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root { background: #3e3e3e; color: #fff; font-family: monospace; margin: 0;}
    
    /* ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®š */
    .sidebar {
      width: 80px; height: 100vh; background: #f0f0f0; display: flex; flex-direction: column;
      justify-content: space-between; align-items: center; padding: 20px 0;
      position: fixed; left: 0; top: 0; box-sizing: border-box; z-index: 100;
    }

    .nav-item {
      text-decoration: none; font-size: 1.8em; transition: 0.2s;
      cursor: pointer; display: flex; justify-content: center; align-items: center;
      width: 100%; height: 60px;
    }

    .nav-item.active {
  
  padding-left: 4px;
  background-color: rgba(0,0,0,0.02);
}

    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
    .main-content { margin-left: 80px; padding: 40px; flex: 1; }
    
    /* ã‚°ãƒ©ãƒ•ã‚«ãƒ¼ãƒ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .chart-card { 
      background: #4a4a4a; 
      border-radius: 24px; 
      padding: 25px; 
      margin-bottom: 30px; /* ã‚«ãƒ¼ãƒ‰åŒå£«ã®é–“éš” */
    }
    
    h2 { margin-top: 0; font-size: 1.2rem; color: #ddd; }
    
    /* ã‚°ãƒ©ãƒ•ã®é«˜ã•ã‚’èª¿æ•´ */
    .chart-container { position: relative; height: 300px; width: 100%; }

    /* --- ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆã®è¨­å®š --- */

/* Whiteãƒ¢ãƒ¼ãƒ‰: æ˜ã‚‹ã„ã‚°ãƒ¬ãƒ¼ã¨ç™½ */
body.White {
    --bg-dark: #f0f0f0;
    --card-bg: #ffffff;
    --panel-bg: #ffffff;
    --text-main: #333333;
    --accent-color: #2c3e50;
    --normal-color: #999999;
}

/* Woodãƒ¢ãƒ¼ãƒ‰: æ¸©ã‹ã¿ã®ã‚ã‚‹èŒ¶ç³» */
body.Wood {
    --bg-dark: #5d4037;
    --card-bg: #8d6e63;
    --panel-bg: #795548;
    --text-main: #fff3e0;
    --accent-color: #ffe082;
    --normal-color: #d7ccc8;
}

/* bodyã®èƒŒæ™¯è‰²ã‚’å¤‰æ•°ã«ã™ã‚‹ã‚ˆã†ä¿®æ­£ */
body {
    margin: 0;
    background-color: var(--bg-dark); /* å›ºå®šè‰²ã‹ã‚‰å¤‰æ•°ã«å¤‰æ›´ */
    color: var(--text-main);
    display: flex;
    transition: background-color 0.3s, color 0.3s; /* åˆ‡ã‚Šæ›¿ãˆã‚’æ»‘ã‚‰ã‹ã« */

}
  </style>
</head>
<body th:class="${mode}">
  <nav class="sidebar">
    <div class="nav-icons">
      <a th:href="@{/}" class="nav-item">ğŸ </a>
      <a th:href="@{/stats}" class="nav-item active">ğŸ“Š</a>
      <a href="/train" class="nav-item">ğŸš†</a>
    </div>
    <div class="nav-bottom">
      <a href="/settings" class="nav-item">âš™ï¸</a>
    </div>
  </nav>

  <main class="main-content">
    <h1>Weather Statistics</h1>
    
    <div class="chart-card">
      <h2>Chance of rain (%)</h2>
      <div class="chart-container">
        <canvas id="rainChart"></canvas>
      </div>
    </div>

    <div class="chart-card">
      <h2>Temperature (â„ƒ)</h2>
      <div class="chart-container">
        <canvas id="tempChart"></canvas>
      </div>
    </div>
  </main>

  <script th:inline="javascript">
    const hourlyData = /*[[${hourlyList}]]*/ [];
    const labels = hourlyData.map(item => item.time);
    
    // ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
    const rainPopData = hourlyData.map(item => item.pop);
    const tempData = hourlyData.map(item => item.temperature); // â€»Javaå´ãŒ temperature ã®å ´åˆã¯ item.temperature ã«å¤‰æ›´

    // å…±é€šã®ã‚¹ã‚±ãƒ¼ãƒ«è¨­å®šï¼ˆè¦‹ãŸç›®ã‚’çµ±ä¸€ã™ã‚‹ãŸã‚ï¼‰
    const commonScales = {
      y: { ticks: { color: '#aaa' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
      x: { ticks: { color: '#aaa' }, grid: { display: false } }
    };

    // --- é™æ°´ç¢ºç‡ï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰ ---
    new Chart(document.getElementById('rainChart'), {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          data: rainPopData,
          backgroundColor: '#77b2cc',
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: { ...commonScales, y: { ...commonScales.y, beginAtZero: true, max: 100 } },
        plugins: { legend: { display: false } }
      }
    });

    // --- æ°—æ¸©ï¼ˆæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ï¼‰ ---
    new Chart(document.getElementById('tempChart'), {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
          data: tempData,
          borderColor: '#ffab91',       // ã‚ªãƒ¬ãƒ³ã‚¸è‰²
          backgroundColor: 'rgba(255, 171, 145, 0.2)',
          fill: true,                   // ç·šã®ä¸‹ã‚’å¡—ã‚Šã¤ã¶ã™
          tension: 0.4,                 // ã‚«ãƒ¼ãƒ–ã‚’æ»‘ã‚‰ã‹ã«ã™ã‚‹
          pointBackgroundColor: '#ffab91',
          pointRadius: 4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: commonScales,
        plugins: { legend: { display: false } }
      }
    });
</script>
</body>
</html>
